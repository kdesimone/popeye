## Customize the test machine on circleci
machine:
    timezone:
        America/New_York
    python:
        version:
            2.7.9
    environment:
        CIRCLE_ENV: test
        COVERAGE: 1
        COVERALLS_REPO_TOKEN: DoqUKyhEKXo6d8DS0y2Bs3klwdzhnz51y

## Customize dependencies
dependencies:
    pre:
        - pip install --upgrade pip
        - pip install pytest
        - pip install pillow
        - pip install numpy
        - pip install nibabel
        - pip install cython
        - pip install scipy
        - pip install sphinx
        - pip install matplotlib
        - pip install sharedmem
        - pip install statsmodels
        - if [ "${COVERAGE}" == "1" ];then pip install pytest-cov; pip install coveralls;fi
        - sudo mkdir tests_dir
        - sudo cp .coveragerc tests_dir/.coveragerc

## Customize the tests
test:
    pre:
        - if [ "${COVERAGE}" == "1" ];then COVER_ARGS="--cov-report term-missing --cov=popeye";fi
    override:
        - py.test --pyargs popeye $COVER_ARGS:
            pwd:
                tests_dir
    post:
        - coveralls
